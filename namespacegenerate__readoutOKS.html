<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DUNE-DAQ: generate_readoutOKS Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DUNE-DAQ
   </div>
   <div id="projectbrief">DUNE Trigger and Data Acquisition software</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">generate_readoutOKS Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a33ad73e8bc909af11c7a6237461c159b" id="r_a33ad73e8bc909af11c7a6237461c159b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegenerate__readoutOKS.html#a33ad73e8bc909af11c7a6237461c159b">generate_readout</a> (readoutmap, oksfile, include, segment, session, emulated_file_name=&quot;asset://?checksum=e96fd6efd3f98a9a3bfaba32975b476e&quot;, tpg_enabled=True)</td></tr>
<tr class="separator:a33ad73e8bc909af11c7a6237461c159b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a324fde533c7ffcb884158f44771c793d" id="r_a324fde533c7ffcb884158f44771c793d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegenerate__readoutOKS.html#a324fde533c7ffcb884158f44771c793d">generate_net_rules</a> (dal, db)</td></tr>
<tr class="separator:a324fde533c7ffcb884158f44771c793d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24ba6e950cd8cb31fc26e43044513b87" id="r_a24ba6e950cd8cb31fc26e43044513b87"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegenerate__readoutOKS.html#a24ba6e950cd8cb31fc26e43044513b87">generate_queue_rules</a> (dal, db)</td></tr>
<tr class="separator:a24ba6e950cd8cb31fc26e43044513b87"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a324fde533c7ffcb884158f44771c793d" name="a324fde533c7ffcb884158f44771c793d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a324fde533c7ffcb884158f44771c793d">&#9670;&#160;</a></span>generate_net_rules()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">generate_readoutOKS.generate_net_rules </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>db</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="generate__readoutOKS_8py_source.html#l00305">305</a> of file <a class="el" href="generate__readoutOKS_8py_source.html">generate_readoutOKS.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  305</span><span class="keyword">def </span>generate_net_rules(dal, db):</div>
<div class="line"><span class="lineno">  306</span>    print(f<span class="stringliteral">&quot;Generating network rules&quot;</span>)</div>
<div class="line"><span class="lineno">  307</span>    netrules = []</div>
<div class="line"><span class="lineno">  308</span>    dataservice = dal.Service(<span class="stringliteral">&quot;dataFragments&quot;</span>, port=0)</div>
<div class="line"><span class="lineno">  309</span>    db.update_dal(dataservice)</div>
<div class="line"><span class="lineno">  310</span>    tpservice = dal.Service(<span class="stringliteral">&quot;triggerPrimitives&quot;</span>, port=0)</div>
<div class="line"><span class="lineno">  311</span>    db.update_dal(tpservice)</div>
<div class="line"><span class="lineno">  312</span>    timeservice = dal.Service(<span class="stringliteral">&quot;timeSync&quot;</span>, port=0)</div>
<div class="line"><span class="lineno">  313</span>    db.update_dal(timeservice)</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>    newdescr = dal.NetworkConnectionDescriptor(</div>
<div class="line"><span class="lineno">  316</span>        <span class="stringliteral">&quot;fa-net-descr&quot;</span>,</div>
<div class="line"><span class="lineno">  317</span>        uid_base=<span class="stringliteral">&quot;data_requests_for_&quot;</span>,</div>
<div class="line"><span class="lineno">  318</span>        connection_type=<span class="stringliteral">&quot;kSendRecv&quot;</span>,</div>
<div class="line"><span class="lineno">  319</span>        data_type=<span class="stringliteral">&quot;DataRequest&quot;</span>,</div>
<div class="line"><span class="lineno">  320</span>        associated_service=dataservice,</div>
<div class="line"><span class="lineno">  321</span>    )</div>
<div class="line"><span class="lineno">  322</span>    db.update_dal(newdescr)</div>
<div class="line"><span class="lineno">  323</span>    newrule = dal.NetworkConnectionRule(</div>
<div class="line"><span class="lineno">  324</span>        <span class="stringliteral">&quot;fa-net-rule&quot;</span>, endpoint_class=<span class="stringliteral">&quot;FragmentAggregator&quot;</span>, descriptor=newdescr</div>
<div class="line"><span class="lineno">  325</span>    )</div>
<div class="line"><span class="lineno">  326</span>    db.update_dal(newrule)</div>
<div class="line"><span class="lineno">  327</span>    netrules.append(newrule)</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>    newdescr = dal.NetworkConnectionDescriptor(</div>
<div class="line"><span class="lineno">  330</span>        <span class="stringliteral">&quot;ta-net-descr&quot;</span>,</div>
<div class="line"><span class="lineno">  331</span>        uid_base=<span class="stringliteral">&quot;ta_&quot;</span>,</div>
<div class="line"><span class="lineno">  332</span>        connection_type=<span class="stringliteral">&quot;kPubSub&quot;</span>,</div>
<div class="line"><span class="lineno">  333</span>        data_type=<span class="stringliteral">&quot;TriggerActivity&quot;</span>,</div>
<div class="line"><span class="lineno">  334</span>        associated_service=dataservice,</div>
<div class="line"><span class="lineno">  335</span>    )</div>
<div class="line"><span class="lineno">  336</span>    db.update_dal(newdescr)</div>
<div class="line"><span class="lineno">  337</span>    newrule = dal.NetworkConnectionRule(</div>
<div class="line"><span class="lineno">  338</span>        <span class="stringliteral">&quot;ta-net-rule&quot;</span>, endpoint_class=<span class="stringliteral">&quot;DataSubscriber&quot;</span>, descriptor=newdescr</div>
<div class="line"><span class="lineno">  339</span>    )</div>
<div class="line"><span class="lineno">  340</span>    db.update_dal(newrule)</div>
<div class="line"><span class="lineno">  341</span>    netrules.append(newrule)</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>    newdescr = dal.NetworkConnectionDescriptor(</div>
<div class="line"><span class="lineno">  344</span>        <span class="stringliteral">&quot;tp-net-descr&quot;</span>,</div>
<div class="line"><span class="lineno">  345</span>        uid_base=<span class="stringliteral">&quot;trigger_primitive_data_request&quot;</span>,</div>
<div class="line"><span class="lineno">  346</span>        connection_type=<span class="stringliteral">&quot;kPubSub&quot;</span>,</div>
<div class="line"><span class="lineno">  347</span>        data_type=<span class="stringliteral">&quot;TPSet&quot;</span>,</div>
<div class="line"><span class="lineno">  348</span>        associated_service=tpservice,</div>
<div class="line"><span class="lineno">  349</span>    )</div>
<div class="line"><span class="lineno">  350</span>    db.update_dal(newdescr)</div>
<div class="line"><span class="lineno">  351</span>    newrule = dal.NetworkConnectionRule(</div>
<div class="line"><span class="lineno">  352</span>        <span class="stringliteral">&quot;tp-net-rule&quot;</span>, endpoint_class=<span class="stringliteral">&quot;FDDataLinkHandler&quot;</span>, descriptor=newdescr</div>
<div class="line"><span class="lineno">  353</span>    )</div>
<div class="line"><span class="lineno">  354</span>    db.update_dal(newrule)</div>
<div class="line"><span class="lineno">  355</span>    netrules.append(newrule)</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span>    newdescr = dal.NetworkConnectionDescriptor(</div>
<div class="line"><span class="lineno">  358</span>        <span class="stringliteral">&quot;ts-net-descr&quot;</span>,</div>
<div class="line"><span class="lineno">  359</span>        uid_base=<span class="stringliteral">&quot;timeSync&quot;</span>,</div>
<div class="line"><span class="lineno">  360</span>        connection_type=<span class="stringliteral">&quot;kPubSub&quot;</span>,</div>
<div class="line"><span class="lineno">  361</span>        data_type=<span class="stringliteral">&quot;TimeSync&quot;</span>,</div>
<div class="line"><span class="lineno">  362</span>        associated_service=timeservice,</div>
<div class="line"><span class="lineno">  363</span>    )</div>
<div class="line"><span class="lineno">  364</span>    db.update_dal(newdescr)</div>
<div class="line"><span class="lineno">  365</span>    newrule = dal.NetworkConnectionRule(</div>
<div class="line"><span class="lineno">  366</span>        <span class="stringliteral">&quot;ts-net-rule&quot;</span>, endpoint_class=<span class="stringliteral">&quot;FDDataLinkHandler&quot;</span>, descriptor=newdescr</div>
<div class="line"><span class="lineno">  367</span>    )</div>
<div class="line"><span class="lineno">  368</span>    db.update_dal(newrule)</div>
<div class="line"><span class="lineno">  369</span>    netrules.append(newrule)</div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordflow">return</span> netrules</div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a24ba6e950cd8cb31fc26e43044513b87" name="a24ba6e950cd8cb31fc26e43044513b87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24ba6e950cd8cb31fc26e43044513b87">&#9670;&#160;</a></span>generate_queue_rules()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">generate_readoutOKS.generate_queue_rules </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>db</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="generate__readoutOKS_8py_source.html#l00373">373</a> of file <a class="el" href="generate__readoutOKS_8py_source.html">generate_readoutOKS.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  373</span><span class="keyword">def </span>generate_queue_rules(dal, db):</div>
<div class="line"><span class="lineno">  374</span>    qrules = []</div>
<div class="line"><span class="lineno">  375</span>    newdescr = dal.QueueDescriptor(</div>
<div class="line"><span class="lineno">  376</span>        <span class="stringliteral">&quot;dataRequest&quot;</span>, queue_type=<span class="stringliteral">&quot;kFollySPSCQueue&quot;</span>, data_type=<span class="stringliteral">&quot;DataRequest&quot;</span>, uid_base=<span class="stringliteral">&quot;data_reqs_for_&quot;</span></div>
<div class="line"><span class="lineno">  377</span>    )</div>
<div class="line"><span class="lineno">  378</span>    db.update_dal(newdescr)</div>
<div class="line"><span class="lineno">  379</span>    newrule = dal.QueueConnectionRule(</div>
<div class="line"><span class="lineno">  380</span>        <span class="stringliteral">&quot;data-requests-queue-rule&quot;</span>,</div>
<div class="line"><span class="lineno">  381</span>        destination_class=<span class="stringliteral">&quot;FDDataLinkHandler&quot;</span>,</div>
<div class="line"><span class="lineno">  382</span>        descriptor=newdescr,</div>
<div class="line"><span class="lineno">  383</span>    )</div>
<div class="line"><span class="lineno">  384</span>    db.update_dal(newrule)</div>
<div class="line"><span class="lineno">  385</span>    qrules.append(newrule)</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>    newdescr = dal.QueueDescriptor(</div>
<div class="line"><span class="lineno">  388</span>        <span class="stringliteral">&quot;aggregatorInput&quot;</span>, queue_type=<span class="stringliteral">&quot;kFollyMPMCQueue&quot;</span>, data_type=<span class="stringliteral">&quot;Fragment&quot;</span>, uid_base=<span class="stringliteral">&quot;fragments_from_&quot;</span></div>
<div class="line"><span class="lineno">  389</span>    )</div>
<div class="line"><span class="lineno">  390</span>    db.update_dal(newdescr)</div>
<div class="line"><span class="lineno">  391</span>    newrule = dal.QueueConnectionRule(</div>
<div class="line"><span class="lineno">  392</span>        <span class="stringliteral">&quot;fa-queue-rule&quot;</span>,</div>
<div class="line"><span class="lineno">  393</span>        destination_class=<span class="stringliteral">&quot;FragmentAggregator&quot;</span>,</div>
<div class="line"><span class="lineno">  394</span>        descriptor=newdescr,</div>
<div class="line"><span class="lineno">  395</span>    )</div>
<div class="line"><span class="lineno">  396</span>    db.update_dal(newrule)</div>
<div class="line"><span class="lineno">  397</span>    qrules.append(newrule)</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>    newdescr = dal.QueueDescriptor(</div>
<div class="line"><span class="lineno">  400</span>        <span class="stringliteral">&quot;rawWIBInput&quot;</span>, queue_type=<span class="stringliteral">&quot;kFollySPSCQueue&quot;</span>, data_type=<span class="stringliteral">&quot;WIBEthFrame&quot;</span>, uid_base=<span class="stringliteral">&quot;raw_&quot;</span></div>
<div class="line"><span class="lineno">  401</span>    )</div>
<div class="line"><span class="lineno">  402</span>    db.update_dal(newdescr)</div>
<div class="line"><span class="lineno">  403</span>    newrule = dal.QueueConnectionRule(</div>
<div class="line"><span class="lineno">  404</span>        <span class="stringliteral">&quot;rawInputRule&quot;</span>, destination_class=<span class="stringliteral">&quot;FDDataLinkHandler&quot;</span>, descriptor=newdescr</div>
<div class="line"><span class="lineno">  405</span>    )</div>
<div class="line"><span class="lineno">  406</span>    db.update_dal(newrule)</div>
<div class="line"><span class="lineno">  407</span>    qrules.append(newrule)</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>    newdescr = dal.QueueDescriptor(</div>
<div class="line"><span class="lineno">  410</span>        <span class="stringliteral">&quot;tpInput&quot;</span>,</div>
<div class="line"><span class="lineno">  411</span>        queue_type=<span class="stringliteral">&quot;kFollyMPMCQueue&quot;</span>,</div>
<div class="line"><span class="lineno">  412</span>        capacity=100000,</div>
<div class="line"><span class="lineno">  413</span>        data_type=<span class="stringliteral">&quot;TriggerPrimitive&quot;</span>,</div>
<div class="line"><span class="lineno">  414</span>        uid_base=<span class="stringliteral">&quot;tps_&quot;</span>        </div>
<div class="line"><span class="lineno">  415</span>    )</div>
<div class="line"><span class="lineno">  416</span>    db.update_dal(newdescr)</div>
<div class="line"><span class="lineno">  417</span>    newrule = dal.QueueConnectionRule(</div>
<div class="line"><span class="lineno">  418</span>        <span class="stringliteral">&quot;tpRule&quot;</span>, destination_class=<span class="stringliteral">&quot;FDDataLinkHandler&quot;</span>, descriptor=newdescr</div>
<div class="line"><span class="lineno">  419</span>    )</div>
<div class="line"><span class="lineno">  420</span>    db.update_dal(newrule)</div>
<div class="line"><span class="lineno">  421</span>    qrules.append(newrule)</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>    <span class="keywordflow">return</span> qrules</div>
</div><!-- fragment -->
</div>
</div>
<a id="a33ad73e8bc909af11c7a6237461c159b" name="a33ad73e8bc909af11c7a6237461c159b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33ad73e8bc909af11c7a6237461c159b">&#9670;&#160;</a></span>generate_readout()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">generate_readoutOKS.generate_readout </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>readoutmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>oksfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>include</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>emulated_file_name</em> = <code>&quot;asset://?checksum=e96fd6efd3f98a9a3bfaba32975b476e&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tpg_enabled</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Simple script to create an OKS configuration file for all
ReadoutApplications defined in a readout map.

The file will automatically include the relevant schema files and
any other OKS files you specify. Any necessary objects not supplied
by included files will be generated and saved in the output file.

Example:
 generate_readoutOKS -i hosts \
   -i appdal/connections.data.xml -i appdal/moduleconfs \
   config/np04readoutmap.data.xml readoutApps.data.xml

Will load hosts, connections and moduleconfs data files as well as
the readoutmap (config/np04readoutmap.data.xml) and write the
generated apps to readoutApps.data.xml.

 generate_readoutOKS --session --segment \
   -i appdal/fsm -i hosts \
   -i appdal/connections.data.xml -i appdal/moduleconfs  \
   config/np04readoutmap.data.xml np04readout-session.data.xml

Will do the same but in addition it will generate a containing
Segment for the apps and a containing Session for the Segment.

NB: Currently FSM generation is not implemented so you must include
an fsm file in order to generate a Segment</pre> 
<p class="definition">Definition at line <a class="el" href="generate__readoutOKS_8py_source.html#l00009">9</a> of file <a class="el" href="generate__readoutOKS_8py_source.html">generate_readoutOKS.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   17</span>):</div>
<div class="line"><span class="lineno">   18</span>    <span class="stringliteral">&quot;&quot;&quot;Simple script to create an OKS configuration file for all</span></div>
<div class="line"><span class="lineno">   19</span><span class="stringliteral">  ReadoutApplications defined in a readout map.</span></div>
<div class="line"><span class="lineno">   20</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   21</span><span class="stringliteral">    The file will automatically include the relevant schema files and</span></div>
<div class="line"><span class="lineno">   22</span><span class="stringliteral">  any other OKS files you specify. Any necessary objects not supplied</span></div>
<div class="line"><span class="lineno">   23</span><span class="stringliteral">  by included files will be generated and saved in the output file.</span></div>
<div class="line"><span class="lineno">   24</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   25</span><span class="stringliteral">   Example:</span></div>
<div class="line"><span class="lineno">   26</span><span class="stringliteral">     generate_readoutOKS -i hosts \</span></div>
<div class="line"><span class="lineno">   27</span><span class="stringliteral">       -i appdal/connections.data.xml -i appdal/moduleconfs \</span></div>
<div class="line"><span class="lineno">   28</span><span class="stringliteral">       config/np04readoutmap.data.xml readoutApps.data.xml</span></div>
<div class="line"><span class="lineno">   29</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   30</span><span class="stringliteral">   Will load hosts, connections and moduleconfs data files as well as</span></div>
<div class="line"><span class="lineno">   31</span><span class="stringliteral">  the readoutmap (config/np04readoutmap.data.xml) and write the</span></div>
<div class="line"><span class="lineno">   32</span><span class="stringliteral">  generated apps to readoutApps.data.xml.</span></div>
<div class="line"><span class="lineno">   33</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   34</span><span class="stringliteral">     generate_readoutOKS --session --segment \</span></div>
<div class="line"><span class="lineno">   35</span><span class="stringliteral">       -i appdal/fsm -i hosts \</span></div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral">       -i appdal/connections.data.xml -i appdal/moduleconfs  \</span></div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral">       config/np04readoutmap.data.xml np04readout-session.data.xml</span></div>
<div class="line"><span class="lineno">   38</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   39</span><span class="stringliteral">   Will do the same but in addition it will generate a containing</span></div>
<div class="line"><span class="lineno">   40</span><span class="stringliteral">  Segment for the apps and a containing Session for the Segment.</span></div>
<div class="line"><span class="lineno">   41</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   42</span><span class="stringliteral">  NB: Currently FSM generation is not implemented so you must include</span></div>
<div class="line"><span class="lineno">   43</span><span class="stringliteral">  an fsm file in order to generate a Segment</span></div>
<div class="line"><span class="lineno">   44</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   45</span><span class="stringliteral">  &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> readoutmap.endswith(<span class="stringliteral">&quot;.data.xml&quot;</span>):</div>
<div class="line"><span class="lineno">   48</span>        readoutmap = readoutmap + <span class="stringliteral">&quot;.data.xml&quot;</span></div>
<div class="line"><span class="lineno">   49</span> </div>
<div class="line"><span class="lineno">   50</span>    print(f<span class="stringliteral">&quot;Readout map file {readoutmap}&quot;</span>)</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>    includefiles = [</div>
<div class="line"><span class="lineno">   53</span>        <span class="stringliteral">&quot;schema/coredal/dunedaq.schema.xml&quot;</span>,</div>
<div class="line"><span class="lineno">   54</span>        <span class="stringliteral">&quot;schema/appdal/application.schema.xml&quot;</span>,</div>
<div class="line"><span class="lineno">   55</span>        <span class="stringliteral">&quot;schema/appdal/trigger.schema.xml&quot;</span>,</div>
<div class="line"><span class="lineno">   56</span>        <span class="stringliteral">&quot;schema/appdal/fdmodules.schema.xml&quot;</span>,</div>
<div class="line"><span class="lineno">   57</span>        readoutmap,</div>
<div class="line"><span class="lineno">   58</span>    ]</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>    searchdirs = [path <span class="keywordflow">for</span> path <span class="keywordflow">in</span> os.environ[<span class="stringliteral">&quot;DUNEDAQ_DB_PATH&quot;</span>].split(<span class="stringliteral">&quot;:&quot;</span>)]</div>
<div class="line"><span class="lineno">   61</span>    searchdirs.append(os.path.dirname(oksfile))</div>
<div class="line"><span class="lineno">   62</span>    <span class="keywordflow">for</span> inc <span class="keywordflow">in</span> include:</div>
<div class="line"><span class="lineno">   63</span>        <span class="comment"># print (f&quot;Searching for {inc}&quot;)</span></div>
<div class="line"><span class="lineno">   64</span>        match = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">   65</span>        inc = inc.removesuffix(<span class="stringliteral">&quot;.xml&quot;</span>)</div>
<div class="line"><span class="lineno">   66</span>        <span class="keywordflow">if</span> inc.endswith(<span class="stringliteral">&quot;.data&quot;</span>):</div>
<div class="line"><span class="lineno">   67</span>            sub_dirs = [<span class="stringliteral">&quot;config&quot;</span>, <span class="stringliteral">&quot;data&quot;</span>]</div>
<div class="line"><span class="lineno">   68</span>        <span class="keywordflow">elif</span> inc.endswith(<span class="stringliteral">&quot;.schema&quot;</span>):</div>
<div class="line"><span class="lineno">   69</span>            sub_dirs = [<span class="stringliteral">&quot;schema&quot;</span>]</div>
<div class="line"><span class="lineno">   70</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   71</span>            sub_dirs = [<span class="stringliteral">&quot;*&quot;</span>]</div>
<div class="line"><span class="lineno">   72</span>            inc = inc + <span class="stringliteral">&quot;*&quot;</span></div>
<div class="line"><span class="lineno">   73</span>        <span class="keywordflow">for</span> path <span class="keywordflow">in</span> searchdirs:</div>
<div class="line"><span class="lineno">   74</span>            <span class="comment"># print (f&quot;   {path}/{inc}.xml&quot;)</span></div>
<div class="line"><span class="lineno">   75</span>            matches = glob.glob(f<span class="stringliteral">&quot;{inc}.xml&quot;</span>, root_dir=path)</div>
<div class="line"><span class="lineno">   76</span>            <span class="keywordflow">if</span> len(matches) == 0:</div>
<div class="line"><span class="lineno">   77</span>                <span class="keywordflow">for</span> search_dir <span class="keywordflow">in</span> sub_dirs:</div>
<div class="line"><span class="lineno">   78</span>                    <span class="comment"># print (f&quot;   {path}/{search_dir}/{inc}.xml&quot;)</span></div>
<div class="line"><span class="lineno">   79</span>                    matches = glob.glob(f<span class="stringliteral">&quot;{search_dir}/{inc}.xml&quot;</span>, root_dir=path)</div>
<div class="line"><span class="lineno">   80</span>                    <span class="keywordflow">for</span> filename <span class="keywordflow">in</span> matches:</div>
<div class="line"><span class="lineno">   81</span>                        <span class="keywordflow">if</span> filename <span class="keywordflow">not</span> <span class="keywordflow">in</span> includefiles:</div>
<div class="line"><span class="lineno">   82</span>                            print(f<span class="stringliteral">&quot;Adding {filename} to include list&quot;</span>)</div>
<div class="line"><span class="lineno">   83</span>                            includefiles.append(filename)</div>
<div class="line"><span class="lineno">   84</span>                        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   85</span>                            print(f<span class="stringliteral">&quot;{filename} already in include list&quot;</span>)</div>
<div class="line"><span class="lineno">   86</span>                        match = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">   87</span>                        <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">   88</span>                    <span class="keywordflow">if</span> match:</div>
<div class="line"><span class="lineno">   89</span>                        <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">   90</span>                <span class="keywordflow">if</span> match:</div>
<div class="line"><span class="lineno">   91</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">   92</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   93</span>                <span class="keywordflow">for</span> filename <span class="keywordflow">in</span> matches:</div>
<div class="line"><span class="lineno">   94</span>                    <span class="keywordflow">if</span> filename <span class="keywordflow">not</span> <span class="keywordflow">in</span> includefiles:</div>
<div class="line"><span class="lineno">   95</span>                        print(f<span class="stringliteral">&quot;Adding {filename} to include list&quot;</span>)</div>
<div class="line"><span class="lineno">   96</span>                        includefiles.append(filename)</div>
<div class="line"><span class="lineno">   97</span>                    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   98</span>                        print(f<span class="stringliteral">&quot;{filename} already in include list&quot;</span>)</div>
<div class="line"><span class="lineno">   99</span>                    match = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  100</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> match:</div>
<div class="line"><span class="lineno">  103</span>            print(f<span class="stringliteral">&quot;Error could not find include file for {inc}&quot;</span>)</div>
<div class="line"><span class="lineno">  104</span>            <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>    dal = <a class="code hl_function" href="namespaceconffwk_1_1dal.html#a639d1cea2a0d7ff650462d1a89044f09">conffwk.dal.module</a>(<span class="stringliteral">&quot;generated&quot;</span>, includefiles[3])</div>
<div class="line"><span class="lineno">  107</span>    db = <a class="code hl_class" href="classconffwk_1_1Configuration_1_1Configuration.html">conffwk.Configuration</a>(<span class="stringliteral">&quot;oksconflibs&quot;</span>)</div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> oksfile.endswith(<span class="stringliteral">&quot;.data.xml&quot;</span>):</div>
<div class="line"><span class="lineno">  109</span>        oksfile = oksfile + <span class="stringliteral">&quot;.data.xml&quot;</span></div>
<div class="line"><span class="lineno">  110</span>    print(f<span class="stringliteral">&quot;Creating OKS database file {oksfile}&quot;</span>)</div>
<div class="line"><span class="lineno">  111</span>    db.create_db(oksfile, includefiles)</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>    rogs = db.get_dals(class_name=<span class="stringliteral">&quot;ReadoutGroup&quot;</span>)</div>
<div class="line"><span class="lineno">  114</span>    hermes_controllers = db.get_dals(class_name=<span class="stringliteral">&quot;HermesController&quot;</span>)</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>    <span class="comment"># Check tpg_enabled here, if it is False, then we want to make our own RawDataProcessor</span></div>
<div class="line"><span class="lineno">  117</span>    <span class="keywordflow">if</span> len(db.get_dals(class_name=<span class="stringliteral">&quot;LatencyBuffer&quot;</span>)) &gt; 0 <span class="keywordflow">and</span> tpg_enabled:</div>
<div class="line"><span class="lineno">  118</span>        print(f<span class="stringliteral">&quot;Using predefined Latency buffers etc.&quot;</span>)</div>
<div class="line"><span class="lineno">  119</span>        reqhandler = db.get_dal(</div>
<div class="line"><span class="lineno">  120</span>            class_name=<span class="stringliteral">&quot;RequestHandler&quot;</span>, uid=<span class="stringliteral">&quot;def-data-request-handler&quot;</span></div>
<div class="line"><span class="lineno">  121</span>        )</div>
<div class="line"><span class="lineno">  122</span>        latencybuffer = db.get_dal(class_name=<span class="stringliteral">&quot;LatencyBuffer&quot;</span>, uid=<span class="stringliteral">&quot;def-latency-buf&quot;</span>)</div>
<div class="line"><span class="lineno">  123</span>        linkhandler = db.get_dal(class_name=<span class="stringliteral">&quot;ReadoutModuleConf&quot;</span>, uid=<span class="stringliteral">&quot;def-link-handler&quot;</span>)</div>
<div class="line"><span class="lineno">  124</span>        tphandler = db.get_dal(class_name=<span class="stringliteral">&quot;ReadoutModuleConf&quot;</span>, uid=<span class="stringliteral">&quot;def-tp-handler&quot;</span>)</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  127</span>        print(f<span class="stringliteral">&quot;Creating locally defined Latency buffers etc.&quot;</span>)</div>
<div class="line"><span class="lineno">  128</span>        reqhandler = dal.RequestHandler(<span class="stringliteral">&quot;rh-1&quot;</span>)</div>
<div class="line"><span class="lineno">  129</span>        db.update_dal(reqhandler)</div>
<div class="line"><span class="lineno">  130</span>        latencybuffer = dal.LatencyBuffer(</div>
<div class="line"><span class="lineno">  131</span>            <span class="stringliteral">&quot;lb-1&quot;</span>,</div>
<div class="line"><span class="lineno">  132</span>            numa_aware=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  133</span>            numa_node=1,</div>
<div class="line"><span class="lineno">  134</span>            size=139008,</div>
<div class="line"><span class="lineno">  135</span>            alignment_size=4096,</div>
<div class="line"><span class="lineno">  136</span>            intrinsic_allocator=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  137</span>        )</div>
<div class="line"><span class="lineno">  138</span>        db.update_dal(latencybuffer)</div>
<div class="line"><span class="lineno">  139</span>        dataproc = dal.RawDataProcessor(</div>
<div class="line"><span class="lineno">  140</span>            <span class="stringliteral">&quot;dataproc-1&quot;</span>,</div>
<div class="line"><span class="lineno">  141</span>            max_ticks_tot=10000,</div>
<div class="line"><span class="lineno">  142</span>            mask_processing=<span class="keyword">False</span>,            </div>
<div class="line"><span class="lineno">  143</span>            algorithm=<span class="stringliteral">&quot;SimpleThreshold&quot;</span>,</div>
<div class="line"><span class="lineno">  144</span>            threshold=1900,</div>
<div class="line"><span class="lineno">  145</span>            channel_map=<span class="stringliteral">&quot;PD2HDChannelMap&quot;</span>,</div>
<div class="line"><span class="lineno">  146</span>            tpg_enabled=tpg_enabled,</div>
<div class="line"><span class="lineno">  147</span>        )</div>
<div class="line"><span class="lineno">  148</span>                    </div>
<div class="line"><span class="lineno">  149</span>        db.update_dal(dataproc)</div>
<div class="line"><span class="lineno">  150</span>        linkhandler = dal.ReadoutModuleConf(</div>
<div class="line"><span class="lineno">  151</span>            <span class="stringliteral">&quot;linkhandler-1&quot;</span>,</div>
<div class="line"><span class="lineno">  152</span>            template_for=<span class="stringliteral">&quot;FDDataLinkHandler&quot;</span>,</div>
<div class="line"><span class="lineno">  153</span>            input_data_type=<span class="stringliteral">&quot;WIBEthFrame&quot;</span>,</div>
<div class="line"><span class="lineno">  154</span>            request_handler=reqhandler,</div>
<div class="line"><span class="lineno">  155</span>            latency_buffer=latencybuffer,</div>
<div class="line"><span class="lineno">  156</span>            data_processor=dataproc,</div>
<div class="line"><span class="lineno">  157</span>        )</div>
<div class="line"><span class="lineno">  158</span>        db.update_dal(linkhandler)</div>
<div class="line"><span class="lineno">  159</span>        tphandler = dal.ReadoutModuleConf(</div>
<div class="line"><span class="lineno">  160</span>            <span class="stringliteral">&quot;tphandler-1&quot;</span>,</div>
<div class="line"><span class="lineno">  161</span>            template_for=<span class="stringliteral">&quot;TriggerDataHandler&quot;</span>,</div>
<div class="line"><span class="lineno">  162</span>            input_data_type=<span class="stringliteral">&quot;TriggerPrimitive&quot;</span>,</div>
<div class="line"><span class="lineno">  163</span>            request_handler=reqhandler,</div>
<div class="line"><span class="lineno">  164</span>            latency_buffer=latencybuffer,</div>
<div class="line"><span class="lineno">  165</span>            data_processor=dataproc,</div>
<div class="line"><span class="lineno">  166</span>        )</div>
<div class="line"><span class="lineno">  167</span>        db.update_dal(tphandler)</div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  169</span>        rule = db.get_dal(class_name=<span class="stringliteral">&quot;NetworkConnectionRule&quot;</span>, uid=<span class="stringliteral">&quot;data-req-net-rule&quot;</span>)</div>
<div class="line"><span class="lineno">  170</span>    <span class="keywordflow">except</span>:</div>
<div class="line"><span class="lineno">  171</span>        <span class="comment"># Failed to get rule, now we have to invent some</span></div>
<div class="line"><span class="lineno">  172</span>        netrules = generate_net_rules(dal, db)</div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  174</span>        netrules = [rule]</div>
<div class="line"><span class="lineno">  175</span>        <span class="comment"># Assume we have all the other rules we need</span></div>
<div class="line"><span class="lineno">  176</span>        <span class="keywordflow">for</span> rule <span class="keywordflow">in</span> [<span class="stringliteral">&quot;tp-net-rule&quot;</span>, <span class="stringliteral">&quot;ts-net-rule&quot;</span>, <span class="stringliteral">&quot;ta-net-rule&quot;</span>]:</div>
<div class="line"><span class="lineno">  177</span>            netrules.append(db.get_dal(class_name=<span class="stringliteral">&quot;NetworkConnectionRule&quot;</span>, uid=rule))</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  180</span>        rule = db.get_dal(</div>
<div class="line"><span class="lineno">  181</span>            class_name=<span class="stringliteral">&quot;QueueConnectionRule&quot;</span>, uid=<span class="stringliteral">&quot;data-requests-queue-rule&quot;</span></div>
<div class="line"><span class="lineno">  182</span>        )</div>
<div class="line"><span class="lineno">  183</span>    <span class="keywordflow">except</span>:</div>
<div class="line"><span class="lineno">  184</span>        qrules = generate_queue_rules(dal, db)</div>
<div class="line"><span class="lineno">  185</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  186</span>        qrules = [rule]</div>
<div class="line"><span class="lineno">  187</span>        <span class="keywordflow">for</span> rule <span class="keywordflow">in</span> [<span class="stringliteral">&quot;fa-queue-rule&quot;</span>, <span class="stringliteral">&quot;wib-eth-raw-data-rule&quot;</span>, <span class="stringliteral">&quot;tp-queue-rule&quot;</span>]:</div>
<div class="line"><span class="lineno">  188</span>            qrules.append(db.get_dal(class_name=<span class="stringliteral">&quot;QueueConnectionRule&quot;</span>, uid=rule))</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>    hosts = []</div>
<div class="line"><span class="lineno">  191</span>    <span class="keywordflow">for</span> host <span class="keywordflow">in</span> db.get_dals(class_name=<span class="stringliteral">&quot;VirtualHost&quot;</span>):</div>
<div class="line"><span class="lineno">  192</span>        hosts.append(host.id)</div>
<div class="line"><span class="lineno">  193</span>    <span class="keywordflow">if</span> <span class="stringliteral">&quot;vlocalhost&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> hosts:</div>
<div class="line"><span class="lineno">  194</span>        cpus = dal.ProcessingResource(<span class="stringliteral">&quot;cpus&quot;</span>, cpu_cores=[0, 1, 2, 3])</div>
<div class="line"><span class="lineno">  195</span>        db.update_dal(cpus)</div>
<div class="line"><span class="lineno">  196</span>        phdal = dal.PhysicalHost(<span class="stringliteral">&quot;localhost&quot;</span>, contains=[cpus])</div>
<div class="line"><span class="lineno">  197</span>        db.update_dal(phdal)</div>
<div class="line"><span class="lineno">  198</span>        host = dal.VirtualHost(<span class="stringliteral">&quot;vlocalhost&quot;</span>, runs_on=phdal, uses=[cpus])</div>
<div class="line"><span class="lineno">  199</span>        db.update_dal(host)</div>
<div class="line"><span class="lineno">  200</span>        hosts.append(<span class="stringliteral">&quot;vlocalhost&quot;</span>)</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>    rohw = dal.RoHwConfig(f<span class="stringliteral">&quot;rohw-{rogs[0].id}&quot;</span>)</div>
<div class="line"><span class="lineno">  203</span>    db.update_dal(rohw)</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>    appnum = 0</div>
<div class="line"><span class="lineno">  206</span>    nicrec = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  207</span>    flxcard = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  208</span>    ruapps = []</div>
<div class="line"><span class="lineno">  209</span>    <span class="keywordflow">for</span> rog <span class="keywordflow">in</span> rogs:</div>
<div class="line"><span class="lineno">  210</span>        hostnum = appnum % len(hosts)</div>
<div class="line"><span class="lineno">  211</span>        <span class="comment"># print(f&quot;Looking up host[{hostnum}] ({hosts[hostnum]})&quot;)</span></div>
<div class="line"><span class="lineno">  212</span>        host = db.get_dal(class_name=<span class="stringliteral">&quot;VirtualHost&quot;</span>, uid=hosts[hostnum])</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>        <span class="comment"># Emulated stream</span></div>
<div class="line"><span class="lineno">  215</span>        <span class="keywordflow">if</span> <a class="code hl_variable" href="TriggerActivity__serialization_8hpp.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>(rog.contains[0]).__name__ == <span class="stringliteral">&quot;ReadoutInterface&quot;</span>:</div>
<div class="line"><span class="lineno">  216</span>            <span class="keywordflow">if</span> nicrec == <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  217</span>                stream_emu = dal.StreamEmulationParameters(</div>
<div class="line"><span class="lineno">  218</span>                    <span class="stringliteral">&quot;stream-emu&quot;</span>,</div>
<div class="line"><span class="lineno">  219</span>                    data_file_name=resolve_asset_file(emulated_file_name),</div>
<div class="line"><span class="lineno">  220</span>                    input_file_size_limit=1000000,</div>
<div class="line"><span class="lineno">  221</span>                    set_t0=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  222</span>                    random_population_size=100000,</div>
<div class="line"><span class="lineno">  223</span>                    frame_error_rate_hz=0,</div>
<div class="line"><span class="lineno">  224</span>                    generate_periodic_adc_pattern=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  225</span>                    TP_rate_per_channel=1,</div>
<div class="line"><span class="lineno">  226</span>                )</div>
<div class="line"><span class="lineno">  227</span>                db.update_dal(stream_emu)</div>
<div class="line"><span class="lineno">  228</span>                print(<span class="stringliteral">&quot;Generating NICReceiverConf&quot;</span>)</div>
<div class="line"><span class="lineno">  229</span>                nicrec = dal.NICReceiverConf(</div>
<div class="line"><span class="lineno">  230</span>                    f<span class="stringliteral">&quot;nicrcvr-1&quot;</span>,</div>
<div class="line"><span class="lineno">  231</span>                    template_for=<span class="stringliteral">&quot;FDFakeCardReader&quot;</span>,</div>
<div class="line"><span class="lineno">  232</span>                    emulation_mode=1,</div>
<div class="line"><span class="lineno">  233</span>                    emulation_conf=stream_emu,</div>
<div class="line"><span class="lineno">  234</span>                )</div>
<div class="line"><span class="lineno">  235</span>                db.update_dal(nicrec)</div>
<div class="line"><span class="lineno">  236</span>            datareader = nicrec</div>
<div class="line"><span class="lineno">  237</span>        <span class="keywordflow">elif</span> <a class="code hl_variable" href="TriggerActivity__serialization_8hpp.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>(rog.contains[0]).__name__ == <span class="stringliteral">&quot;NICInterface&quot;</span>:</div>
<div class="line"><span class="lineno">  238</span>            <span class="keywordflow">if</span> nicrec == <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  239</span>                print(<span class="stringliteral">&quot;Generating NICReceiverConf&quot;</span>)</div>
<div class="line"><span class="lineno">  240</span>                nicrec = dal.NICReceiverConf(f<span class="stringliteral">&quot;nicrcvr-1&quot;</span>, template_for=<span class="stringliteral">&quot;NICReceiver&quot;</span>)</div>
<div class="line"><span class="lineno">  241</span>                db.update_dal(nicrec)</div>
<div class="line"><span class="lineno">  242</span>            datareader = nicrec</div>
<div class="line"><span class="lineno">  243</span>            hermes_app = dal.DaqApplication(</div>
<div class="line"><span class="lineno">  244</span>                f<span class="stringliteral">&quot;hermes-{rog.id}&quot;</span>, runs_on=host, modules=hermes_controllers</div>
<div class="line"><span class="lineno">  245</span>            )</div>
<div class="line"><span class="lineno">  246</span>            db.update_dal(hermes_app)</div>
<div class="line"><span class="lineno">  247</span>        <span class="keywordflow">elif</span> <a class="code hl_variable" href="TriggerActivity__serialization_8hpp.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>(rog.contains[0]).__name__ == <span class="stringliteral">&quot;FelixInterface&quot;</span>:</div>
<div class="line"><span class="lineno">  248</span>            <span class="keywordflow">if</span> flxcard == <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  249</span>                print(<span class="stringliteral">&quot;Generating Felix DataReaderConf&quot;</span>)</div>
<div class="line"><span class="lineno">  250</span>                flxcard = dal.DataReaderConf(</div>
<div class="line"><span class="lineno">  251</span>                    f<span class="stringliteral">&quot;flxConf-1&quot;</span>, template_for=<span class="stringliteral">&quot;FelixCardReader&quot;</span></div>
<div class="line"><span class="lineno">  252</span>                )</div>
<div class="line"><span class="lineno">  253</span>                db.update_dal(flxcard)</div>
<div class="line"><span class="lineno">  254</span>            datareader = flxcard</div>
<div class="line"><span class="lineno">  255</span>        <span class="keywordflow">else</span> :</div>
<div class="line"><span class="lineno">  256</span>            print(f<span class="stringliteral">&quot;ReadoutGroup contains unknown interface type {type(rog.contains[0]).__name__}&quot;</span>)</div>
<div class="line"><span class="lineno">  257</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>        ru = dal.ReadoutApplication(</div>
<div class="line"><span class="lineno">  260</span>            f<span class="stringliteral">&quot;ru-{rog.id}&quot;</span>,</div>
<div class="line"><span class="lineno">  261</span>            runs_on=host,</div>
<div class="line"><span class="lineno">  262</span>            contains=[rog],</div>
<div class="line"><span class="lineno">  263</span>            network_rules=netrules,</div>
<div class="line"><span class="lineno">  264</span>            queue_rules=qrules,</div>
<div class="line"><span class="lineno">  265</span>            link_handler=linkhandler,</div>
<div class="line"><span class="lineno">  266</span>            data_reader=datareader,</div>
<div class="line"><span class="lineno">  267</span>            uses=rohw,</div>
<div class="line"><span class="lineno">  268</span>        )</div>
<div class="line"><span class="lineno">  269</span>        <span class="keywordflow">if</span> tpg_enabled:</div>
<div class="line"><span class="lineno">  270</span>            ru.tp_handler = tphandler</div>
<div class="line"><span class="lineno">  271</span>            ru.tp_source_id=appnum + 100</div>
<div class="line"><span class="lineno">  272</span>            ru.ta_source_id=appnum + 1000</div>
<div class="line"><span class="lineno">  273</span>        appnum = appnum + 1</div>
<div class="line"><span class="lineno">  274</span>        print(f<span class="stringliteral">&quot;{ru=}&quot;</span>)</div>
<div class="line"><span class="lineno">  275</span>        db.update_dal(ru)</div>
<div class="line"><span class="lineno">  276</span>        ruapps.append(ru)</div>
<div class="line"><span class="lineno">  277</span>    <span class="keywordflow">if</span> appnum == 0:</div>
<div class="line"><span class="lineno">  278</span>        print(f<span class="stringliteral">&quot;No ReadoutApplications generated\n&quot;</span>)</div>
<div class="line"><span class="lineno">  279</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>    <span class="keywordflow">if</span> segment <span class="keywordflow">or</span> session:</div>
<div class="line"><span class="lineno">  282</span>        fsm = db.get_dal(class_name=<span class="stringliteral">&quot;FSMconfiguration&quot;</span>, uid=<span class="stringliteral">&quot;fsmConf-1&quot;</span>)</div>
<div class="line"><span class="lineno">  283</span>        controller = dal.RCApplication(<span class="stringliteral">&quot;ru-controller&quot;</span>, runs_on=host, fsm=fsm)</div>
<div class="line"><span class="lineno">  284</span>        db.update_dal(controller)</div>
<div class="line"><span class="lineno">  285</span>        seg = dal.Segment(f<span class="stringliteral">&quot;ru-segment&quot;</span>, controller=controller, applications=ruapps)</div>
<div class="line"><span class="lineno">  286</span>        db.update_dal(seg)</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>        <span class="keywordflow">if</span> session:</div>
<div class="line"><span class="lineno">  289</span>            ro_maps = db.get_dals(class_name=<span class="stringliteral">&quot;ReadoutMap&quot;</span>)</div>
<div class="line"><span class="lineno">  290</span>            detconf = dal.DetectorConfig(<span class="stringliteral">&quot;dummy-detector&quot;</span>)</div>
<div class="line"><span class="lineno">  291</span>            db.update_dal(detconf)</div>
<div class="line"><span class="lineno">  292</span>            sessname = os.path.basename(readoutmap).removesuffix(<span class="stringliteral">&quot;.data.xml&quot;</span>)</div>
<div class="line"><span class="lineno">  293</span>            sessiondal = dal.Session(</div>
<div class="line"><span class="lineno">  294</span>                f<span class="stringliteral">&quot;{sessname}-session&quot;</span>,</div>
<div class="line"><span class="lineno">  295</span>                segment=seg,</div>
<div class="line"><span class="lineno">  296</span>                detector_configuration=detconf,</div>
<div class="line"><span class="lineno">  297</span>                readout_map=ro_maps[0],</div>
<div class="line"><span class="lineno">  298</span>            )</div>
<div class="line"><span class="lineno">  299</span>            db.update_dal(sessiondal)</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>    db.commit()</div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="ttc" id="aTriggerActivity__serialization_8hpp_html_a7aead736a07eaf25623ad7bfa1f0ee2d"><div class="ttname"><a href="TriggerActivity__serialization_8hpp.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition</b> <a href="TriggerActivity__serialization_8hpp_source.html#l00048">TriggerActivity_serialization.hpp:48</a></div></div>
<div class="ttc" id="aclassconffwk_1_1Configuration_1_1Configuration_html"><div class="ttname"><a href="classconffwk_1_1Configuration_1_1Configuration.html">conffwk.Configuration.Configuration</a></div><div class="ttdef"><b>Definition</b> <a href="Configuration_8py_source.html#l00024">Configuration.py:24</a></div></div>
<div class="ttc" id="anamespaceconffwk_1_1dal_html_a639d1cea2a0d7ff650462d1a89044f09"><div class="ttname"><a href="namespaceconffwk_1_1dal.html#a639d1cea2a0d7ff650462d1a89044f09">conffwk.dal.module</a></div><div class="ttdeci">module(name, schema, other_dals=[], backend='oksconflibs', db=None)</div><div class="ttdef"><b>Definition</b> <a href="dal_8py_source.html#l00673">dal.py:673</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
